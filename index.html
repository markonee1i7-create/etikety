
<!DOCTYPE html>
<html lang="sk">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Sklad ‚Äì V√Ωdaj & Invent√∫ra</title>

<!-- QR kni≈ænica -->
<script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>

<style>
/* ===== Z√ÅKLAD ===== */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  background: #f8fafc;
}

header {
  background: #0ea5a4;
  color: white;
  padding: 16px;
  font-size: 20px;
  font-weight: 800;
}

/* ===== FORMUL√ÅRE ===== */
.section {
  padding: 16px;
}

label {
  display: block;
  font-weight: 700;
  margin-top: 12px;
}

input {
  width: 100%;
  padding: 14px;
  font-size: 16px;
  border: 2px solid #e5e7eb;
  border-radius: 12px;
}

/* ===== TLAƒåIDL√Å ===== */
button {
  margin-top: 12px;
  width: 100%;
 
  font-size: 16px;
  font-weight: 800;
  border-radius: 14px;
  border: none;
}

.primary { background:#0ea5a4; color:white }
.dark { background:#111827; color:white }

/* ===== SKENER ===== */
#scannerOverlay {
  position: fixed;
  inset: 0;
  background: black;
  display: none;
  flex-direction: column;
  z-index: 1000;
}

#scannerControls {
  background: rgba(0,0,0,0.6);
  padding: 12px;
}

#scanner {
  width: 100%;
  min-height: 70vh;   /* ‚≠ê KRITICK√ù FIX PRE iOS */
}

/* ===== TABUIKA ===== */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 16px;
}
th, td {
  border: 1px solid #e5e7eb;
  padding: 10px;
  font-size: 14px;
}
th {
  background: #f1f5f9;
}
</style>
</head>

<body>

<header>Sklad ‚Äì V√Ωdaj & Invent√∫ra</header>

<div class="section">

<label>CJL ƒç√≠slo</label>
<input id="cjl">

<button class="primary" onclick="openScanner()">üì∑ Skenova≈• QR</button>

<label>Mno≈æstvo</label>
<input id="qty" type="number" value="1">

<button class="dark" onclick="addRow()">‚úÖ Potvrdi≈• v√Ωdaj</button>

<table id="table">
<thead>
<tr>
<th>D√°tum</th>
<th>CJL</th>
<th>Mno≈æstvo</th>
</tr>
</thead>
<tbody></tbody>
</table>

</div>

<!-- ===== OVERLAY SKENER ===== -->
<div id="scannerOverlay">

<div id="scannerControls">
<button class="dark" onclick="closeScanner()">‚úï Zavrie≈• skener</button>
</div>

<div id="scanner"></div>

</div>

<script>
let qr;

function openScanner() {
  document.getElementById("scannerOverlay").style.display = "flex";

  if (qr) {
    qr.stop().catch(()=>{});
  }

  qr = new Html5Qrcode("scanner");

  qr.start(
    { facingMode: { exact: "environment" } },
    {
      fps: 15,
      qrbox: (w, h) => {
        const s = Math.min(w, h);
        return { width: s * 0.6, height: s * 0.6 };
      }
    },
    text => {
      document.getElementById("cjl").value = text;
      closeScanner();
    }
  ).then(() => {
    const video = document.querySelector("#scanner video");
    if (video) {
      video.setAttribute("playsinline", true);
      video.setAttribute("webkit-playsinline", true);
      video.muted = true;
    }
  });
}

function closeScanner() {
  document.getElementById("scannerOverlay").style.display = "none";
  if (qr) qr.stop().catch(()=>{});
}

function addRow() {
  const cjl = document.getElementById("cjl").value;
  const qty = document.getElementById("qty").value;
  if (!cjl) return alert("Ch√Ωba CJL");

  const row = document.createElement("tr");
  row.innerHTML =
    `<td>${new Date().toLocaleString()}</td>
     <td>${cjl}</td>
     <td>${qty}</td>`;

  document.querySelector("#table tbody").prepend(row);
  document.getElementById("cjl").value = "";
}
</script>

</body>
</html>
